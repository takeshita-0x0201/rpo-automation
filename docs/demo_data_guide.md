# デモデータ使用ガイド

## 概要
AIマッチングが完了したジョブのデモデータを用意しました。これにより、候補者選択画面の動作を確認できます。

## デモデータの内容

### クライアント
- **企業名**: 株式会社テックコーポレーション
- **業界**: IT
- **規模**: 大企業

### 採用要件
- **ポジション**: バックエンドエンジニア（テックリード）
- **必須スキル**: Java, Spring Boot, AWS, チームリード経験
- **歓迎スキル**: Kubernetes, マイクロサービス, DDD
- **チーム規模**: 8名
- **年収レンジ**: 700-1000万円

### 候補者データ（4名）

#### 1. 高評価候補者A（スコア: 92%）
- **ID**: BZ2024001
- **現職**: 株式会社イノベーションテック / シニアエンジニア
- **特徴**: 
  - 全ての必須要件を満たす
  - ECプラットフォーム開発経験
  - 5名のチームリード経験

#### 2. 高評価候補者B（スコア: 88%）
- **ID**: BZ2024002
- **現職**: 株式会社クラウドシステムズ / テックリード
- **特徴**:
  - 10名のチームリード経験
  - Kubernetes 3年の経験
  - DDD実践経験あり

#### 3. 中評価候補者（スコア: 65%）
- **ID**: BZ2024003
- **現職**: 大手SIer A社 / プロジェクトマネージャー
- **特徴**:
  - Java経験10年と豊富
  - クラウド/モダン技術の経験不足
  - SIer文化とのギャップ懸念

#### 4. 低評価候補者（スコア: 25%）
- **ID**: BZ2024004
- **現職**: フリーランス / Webデザイナー
- **特徴**:
  - フロントエンド専門
  - バックエンド経験なし
  - 必須要件を満たさない

## デモデータの適用方法

```bash
# 1. Supabaseに接続
psql postgresql://[USER]:[PASSWORD]@[HOST]:[PORT]/[DATABASE]

# 2. SQLファイルを実行
\i sql/demo_data_completed_job.sql

# または直接実行
psql postgresql://[接続文字列] -f sql/demo_data_completed_job.sql
```

## 動作確認手順

1. **WebAppにログイン**
   - 管理者権限でログイン

2. **ジョブ一覧画面**
   - `/admin/jobs` にアクセス
   - 「株式会社テックコーポレーション」の完了済みジョブを確認
   - 「候補者選択」ボタンが表示されていることを確認

3. **候補者選択画面**
   - 「候補者選択」ボタンをクリック
   - 4名の候補者が表示されることを確認
   - 統計情報（強く推奨: 2名、推奨: 1名、要検討: 1名）を確認

4. **フィルタリング機能**
   - 「強く推奨のみ」をクリック → 2名表示
   - 「推奨以上」をクリック → 3名表示
   - 「全て表示」をクリック → 4名表示

5. **候補者選択**
   - チェックボックスで候補者を選択
   - 選択数がカウントされることを確認
   - 「送客リストに追加」ボタンが有効になることを確認

6. **詳細表示**
   - 各候補者の「目」アイコンをクリック
   - モーダルで詳細情報が表示されることを確認
   - 職務経歴、マッチ理由、懸念事項が確認できること

## トラブルシューティング

### エラー: "candidate_id violates foreign key constraint"
原因: candidatesテーブルの構造が異なる可能性があります。
対処: 
```sql
-- 既存データをクリア
DELETE FROM ai_evaluations WHERE search_id = '33333333-3333-3333-3333-333333333333';
DELETE FROM candidates WHERE requirement_id = '22222222-2222-2222-2222-222222222222';
DELETE FROM jobs WHERE id = '33333333-3333-3333-3333-333333333333';

-- 再度実行
\i sql/demo_data_completed_job.sql
```

### 候補者が表示されない
原因: search_idの不一致
対処:
```sql
-- ai_evaluationsのsearch_idを確認
UPDATE ai_evaluations 
SET search_id = '33333333-3333-3333-3333-333333333333'
WHERE requirement_id = '22222222-2222-2222-2222-222222222222';
```

## デモ後のクリーンアップ

```sql
-- デモデータを削除
DELETE FROM ai_evaluations WHERE search_id = '33333333-3333-3333-3333-333333333333';
DELETE FROM candidates WHERE requirement_id = '22222222-2222-2222-2222-222222222222';
DELETE FROM searches WHERE id = '33333333-3333-3333-3333-333333333333';
DELETE FROM jobs WHERE id = '33333333-3333-3333-3333-333333333333';
DELETE FROM job_requirements WHERE id = '22222222-2222-2222-2222-222222222222';
-- クライアントは他で使用している可能性があるため、慎重に削除
-- DELETE FROM clients WHERE id = '11111111-1111-1111-1111-111111111111';
```